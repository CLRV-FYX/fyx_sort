name: Minimal CI

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Compile and test
      run: |
        # 编译测试程序
        g++ -std=c++17 -O2 -DFYX_MAIN -o test_fyx fyx_sort.hpp
        
        # 运行测试
        ./test_fyx
    
    - name: Test different configurations
      run: |
        echo "Testing parallel version..."
        g++ -std=c++17 -O2 -DFYX_MAIN -DFYX_ENABLE_PARALLEL=1 -o test_parallel fyx_sort.hpp
        timeout 10s ./test_parallel || true
        
        echo "Testing sequential version..."
        g++ -std=c++17 -O2 -DFYX_MAIN -DFYX_ENABLE_PARALLEL=0 -o test_seq fyx_sort.hpp
        timeout 10s ./test_seq || true
